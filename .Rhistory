purchase_make_df <- table(df1$purchase_make)
purchase_make_df <- as.data.frame(purchase_make_df)
View(purchase_make_df)
#Vehicle Sales by Manufacturer
purchase_make_df <- table(df1$purchase_make)
purchase_make_df <- as.data.frame(purchase_make_df)
View(purchase_make_df)
#Vehicle Sales by Manufacturer
purchase_make_df <- table(df1$purchase_make)
View(df1)
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
rename(purchase_make = Var1)
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
rename(purchase_make = Var1) %>%
top_n(10, Freq) %>%
arrange(desc(Freq))
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
rename(Var1 = purchase_make) %>%
top_n(10, Freq) %>%
arrange(desc(Freq))
#Clear workspace
rm(list = ls())
#Set working directory
setwd("C:/Users/Danny/Desktop/CarMax-Analytics-Showcase")
#Import Libraries
library(dplyr)
library(ggplot2)
library(naniar)
#Import Dataset
df1 <- read.csv("CaseCompetitionData2021Copy.csv")
#Averages
mean(df1$trade_in)
mean(df1$vehicle_financing)
mean(df1$customer_previous_purchase)
mean(df1$subsequent_purchases)
#Vehicle Sales by Manufacturer
purchase_make_df <- table(df1$purchase_make)
purchase_make_df <- as.data.frame(purchase_make_df)
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
rename(Var1 = purchase_make) %>%
top_n(10, Freq) %>%
arrange(desc(Freq))
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
top_n(10, Freq) %>%
arrange(desc(Freq))
View(top10)
#Top Ten Manufacturer as a percentage of Sales Quantity
percent_sales_top_10 <- sum(top10$Freq)/length(df1$purchase_make)
percent_sales_top_10
manufacturer_graph <- ggplot(top10, aes(x=Var1, y=Freq)) +
geom_bar(stat = "identity") +
theme_minimal()
manufacturer_graph
manufacturer_graph <- ggplot(top10, aes(x=reorder(Var1, -Freq), y=Freq)) +
geom_bar(stat = "identity") +
theme_minimal()
manufacturer_graph
#Averages
mean(df1$trade_in)
#Clear workspace
rm(list = ls())
#Set working directory
setwd("C:/Users/Danny/Desktop/CarMax-Analytics-Showcase")
#Import Libraries
library(dplyr)
library(ggplot2)
library(naniar)
#Import Dataset
df1 <- read.csv("CaseCompetitionData2021Copy.csv")
#Averages
mean(df1$trade_in)
mean(df1$vehicle_financing)
mean(df1$customer_previous_purchase)
mean(df1$subsequent_purchases)
#Vehicle Sales by Manufacturer
purchase_make_df <- table(df1$purchase_make)
purchase_make_df <- as.data.frame(purchase_make_df)
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
top_n(10, Freq) %>%
arrange(desc(Freq))
#Top Ten Manufacturer as a percentage of Sales Quantity
percent_sales_top_10 <- sum(top10$Freq)/length(df1$purchase_make)
percent_sales_top_10
manufacturer_graph <- ggplot(top10, aes(x=reorder(Var1, -Freq), y=Freq)) +
geom_bar(stat = "identity") +
theme_minimal()
manufacturer_graph
customer_satisfaction <- df1 %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
na.omit()
View(customer_satisfaction)
library(corrplot)
m <- cor(customer_satisfaction)
View(customer_satisfaction)
customer_satisfaction <- df1 %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
na.omit()
View(customer_satisfaction)
customer_satisfaction_num <- customer_satisfaction[,sapply(customer_satisfaction, is.numeric)]
View(customer_satisfaction)
View(customer_satisfaction_num)
customer_satisfaction_cor <- cor(customer_satisfaction_num)
corrplot(customer_satisfaction_cor)
View(customer_satisfaction)
knitr::opts_chunk$set(echo = TRUE)
library(cowplot)
library(randomForest)
install.packages("randomForest")
library(randomForest)
knitr::opts_chunk$set(echo = TRUE)
#Clear workspace
rm(list = ls())
#Set working directory
setwd("C:/Users/Danny/Desktop/CarMax-Analytics-Showcase")
#Import Libraries
library(dplyr)
library(ggplot2)
library(naniar)
library(corrplot)
library(cowplot)
library(randomForest)
#Import Dataset
df1 <- read.csv("CaseCompetitionData2021Copy.csv")
#Averages
mean(df1$trade_in)
mean(df1$vehicle_financing)
mean(df1$customer_previous_purchase)
mean(df1$subsequent_purchases)
#Vehicle Sales by Manufacturer
purchase_make_df <- table(df1$purchase_make)
purchase_make_df <- as.data.frame(purchase_make_df)
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
top_n(10, Freq) %>%
arrange(desc(Freq))
#Top Ten Manufacturer as a percentage of Sales Quantity
percent_sales_top_10 <- sum(top10$Freq)/length(df1$purchase_make)
percent_sales_top_10
manufacturer_graph <- ggplot(top10, aes(x=reorder(Var1, -Freq), y=Freq)) +
geom_bar(stat = "identity") +
theme_minimal()
manufacturer_graph
customer_satisfaction <- df1 %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
na.omit()
customer_satisfaction_num <- customer_satisfaction[,sapply(customer_satisfaction, is.numeric)]
customer_satisfaction_cor <- cor(customer_satisfaction_num)
corrplot(customer_satisfaction_cor)
View(customer_satisfaction)
corr(customer_satisfaction$post_purchase_satisfaction, customer_satisfaction$subsequent_purchases)
cor(customer_satisfaction$post_purchase_satisfaction, customer_satisfaction$subsequent_purchases)
View(customer_satisfaction_num)
View(customer_satisfaction)
View(customer_satisfaction_num)
View(customer_satisfaction)
customer_satisfaction <- df1 %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
mutate(post_purchase_satisfaction = as.numeric(post_purchase_satisfaction))
customer_satisfaction <- df1 %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
mutate(post_purchase_satisfaction = as.numeric(post_purchase_satisfaction))%>%
na.omit()
customer_satisfaction_num <- customer_satisfaction[,sapply(customer_satisfaction, is.numeric)]
customer_satisfaction_cor <- cor(customer_satisfaction_num)
corrplot(customer_satisfaction_cor)
View(df1)
View(customer_satisfaction_num)
View(df1)
table(df1$post_purchase_satisfaction)
table(df1$customer_gender)
View(df1)
count(unique(df1$insert_num))
table(df1$insert_num)
View(df1)
#Import Dataset
df1_raw <- read.csv("CaseCompetitionData2021Copy.csv")
#Clear workspace
rm(list = ls())
#Set working directory
setwd("C:/Users/Danny/Desktop/CarMax-Analytics-Showcase")
#Import Libraries
library(dplyr)
library(ggplot2)
library(naniar)
library(corrplot)
library(cowplot)
library(randomForest)
#Import Dataset
df1_raw <- read.csv("CaseCompetitionData2021Copy.csv")
View(df1_raw)
summary(df1_raw)
table(purchase_year)
table(df1_raw$purchase_vehicle_year)
table(df1_raw$purchase_make)
table(df1_raw$purchase_price)
colSums(is.na(df1_raw))
View(df1_raw)
table(df1_raw$subsequent_purchases)
table(df1_raw$purchase_model)
View(df1_raw)
View(df1_raw)
df1 <- df1_raw
table(df1$customer_gender)
gender_table <- table(df1$customer_gender)
gender_table_df <- as.data.frame(gender_table)
View(gender_table_df)
gender_table_df$Var1 <- gender_table_df$customer_gender
View(gender_table_df)
gender_table <- table(df1$customer_gender)
gender_table_df <- as.data.frame(gender_table)
gender_table_df$Var1 <- gender_table_df$customer_gender
View(gender_table_df)
rename(gender_table_df, customer_gender = Var1)
#Clear workspace
rm(list = ls())
#Set working directory
setwd("C:/Users/Danny/Desktop/CarMax-Analytics-Showcase")
#Import Libraries
library(dplyr)
library(ggplot2)
library(naniar)
library(corrplot)
library(cowplot)
library(randomForest)
#Import Dataset
df1_raw <- read.csv("CaseCompetitionData2021Copy.csv")
df1 <- df1_raw
gender_table <- table(df1$customer_gender)
gender_table_df <- as.data.frame(gender_table)
rename(gender_table_df, customer_gender = Var1)
View(gender_table_df)
View(gender_table_df)
gender_table_df <- rename(gender_table_df, customer_gender = Var1)
View(gender_table_df)
df1[df == "?"] <- NA
View(df1)
df1[df1=="?"]<- NA
View(df1)
#Omit NA values
df1 <- na.omit(df1)
df1 <- df1_raw
#Replacing ? Values with NA
df1[df1=="?"]<- NA
#Drop Columns
df1 <- select(df1, -post_purchase_satisfaction)
#New Dataset for Cleaning and Analysis
df1 <- df1_raw
#Replacing ? Values with NA
df1[df1=="?"]<- NA
#Drop Columns
df1 <- select(df1, -post_purchase_satisfaction) %>%
#Omit NA values
df1 <- na.omit(df1)
#Drop Columns
df1 <- select(df1, -post_purchase_satisfaction)
#Omit NA values
df1 <- na.omit(df1)
View(df1)
#customers by gender
gender_table <- table(df1$customer_gender)
gender_table_df <- as.data.frame(gender_table)
gender_table_df <- rename(gender_table_df, customer_gender = Var1)
#Averages
mean(df1$trade_in)
mean(df1$vehicle_financing)
mean(df1$customer_previous_purchase)
mean(df1$subsequent_purchases)
#Vehicle Sales by Manufacturer
purchase_make_df <- table(df1$purchase_make)
purchase_make_df <- as.data.frame(purchase_make_df)
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
top_n(10, Freq) %>%
arrange(desc(Freq))
#Top Ten Manufacturer as a percentage of Sales Quantity
percent_sales_top_10 <- sum(top10$Freq)/length(df1$purchase_make)
percent_sales_top_10
manufacturer_graph <- ggplot(top10, aes(x=reorder(Var1, -Freq), y=Freq)) +
geom_bar(stat = "identity") +
theme_minimal()
manufacturer_graph
customer_satisfaction <- df1 %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
mutate(post_purchase_satisfaction = as.numeric(post_purchase_satisfaction))%>%
na.omit()
customer_satisfaction <- df1_raw %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
mutate(post_purchase_satisfaction = as.numeric(post_purchase_satisfaction))%>%
na.omit()
customer_satisfaction_num <- customer_satisfaction[,sapply(customer_satisfaction, is.numeric)]
customer_satisfaction_cor <- cor(customer_satisfaction_num)
corrplot(customer_satisfaction_cor)
#Drop Columns
df1 <- select(df1, -post_purchase_satisfaction)
#Omit NA values
df1 <- na.omit(df1)
#Clear workspace
rm(list = ls())
#Set working directory
setwd("C:/Users/Danny/Desktop/CarMax-Analytics-Showcase")
#Import Libraries
library(dplyr)
library(ggplot2)
library(naniar)
library(corrplot)
library(cowplot)
library(randomForest)
#Import Dataset
df1_raw <- read.csv("CaseCompetitionData2021Copy.csv")
#New Dataset for Cleaning and Analysis
df1 <- df1_raw
#Replacing ? Values with NA
df1[df1=="?"]<- NA
#Drop Columns
df1 <- select(df1, -post_purchase_satisfaction)
#Omit NA values
df1 <- na.omit(df1)
#customers by gender
gender_table <- table(df1$customer_gender)
gender_table_df <- as.data.frame(gender_table)
gender_table_df <- rename(gender_table_df, customer_gender = Var1)
#Averages
mean(df1$trade_in)
mean(df1$vehicle_financing)
mean(df1$customer_previous_purchase)
mean(df1$subsequent_purchases)
#Vehicle Sales by Manufacturer
purchase_make_df <- table(df1$purchase_make)
purchase_make_df <- as.data.frame(purchase_make_df)
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
top_n(10, Freq) %>%
arrange(desc(Freq))
#Top Ten Manufacturer as a percentage of Sales Quantity
percent_sales_top_10 <- sum(top10$Freq)/length(df1$purchase_make)
percent_sales_top_10
manufacturer_graph <- ggplot(top10, aes(x=reorder(Var1, -Freq), y=Freq)) +
geom_bar(stat = "identity") +
theme_minimal()
manufacturer_graph
customer_satisfaction <- df1_raw %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
mutate(post_purchase_satisfaction = as.numeric(post_purchase_satisfaction))%>%
na.omit()
customer_satisfaction_num <- customer_satisfaction[,sapply(customer_satisfaction, is.numeric)]
customer_satisfaction_cor <- cor(customer_satisfaction_num)
corrplot(customer_satisfaction_cor)
View(df1)
vehicle_year_df <- df1
purchase_year <- 2013
vehicle_year_df$purchase_vehicle_year_lag <- (purchase_year - vehicle_year_df$purchase_vehicle_year)
View(vehicle_year_df)
boxplot(vehicle_year_df$purchase_vehicle_year_lag)
plot(vehicle_year_df$purchase_vehicle_year_lag)
knitr::opts_chunk$set(echo = TRUE)
#Clear workspace
rm(list = ls())
#Set working directory
setwd("C:/Users/Danny/Desktop/CarMax-Analytics-Showcase")
#Import Libraries
library(dplyr)
library(ggplot2)
library(naniar)
library(corrplot)
library(cowplot)
library(randomForest)
#Import Dataset
df1_raw <- read.csv("CaseCompetitionData2021Copy.csv")
#New Dataset for Cleaning and Analysis
df1 <- df1_raw
#Replacing ? Values with NA
df1[df1=="?"]<- NA
#Drop Columns
df1 <- select(df1, -post_purchase_satisfaction)
#Omit NA values
df1 <- na.omit(df1)
#customers by gender
gender_table <- table(df1$customer_gender)
gender_table_df <- as.data.frame(gender_table)
gender_table_df <- rename(gender_table_df, customer_gender = Var1)
#Averages
mean(df1$trade_in)
mean(df1$vehicle_financing)
mean(df1$customer_previous_purchase)
mean(df1$subsequent_purchases)
#Vehicle Sales by Manufacturer
purchase_make_df <- table(df1$purchase_make)
purchase_make_df <- as.data.frame(purchase_make_df)
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
top_n(10, Freq) %>%
arrange(desc(Freq))
#Top Ten Manufacturer as a percentage of Sales Quantity
percent_sales_top_10 <- sum(top10$Freq)/length(df1$purchase_make)
percent_sales_top_10
manufacturer_graph <- ggplot(top10, aes(x=reorder(Var1, -Freq), y=Freq)) +
geom_bar(stat = "identity") +
theme_minimal()
manufacturer_graph
customer_satisfaction <- df1_raw %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
mutate(post_purchase_satisfaction = as.numeric(post_purchase_satisfaction))%>%
na.omit()
customer_satisfaction_num <- customer_satisfaction[,sapply(customer_satisfaction, is.numeric)]
customer_satisfaction_cor <- cor(customer_satisfaction_num)
corrplot(customer_satisfaction_cor)
vehicle_year_df$purchase_vehicle_year_lag <- (purchase_year - vehicle_year_df$purchase_vehicle_year)
customer_satisfaction <- df1_raw %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
mutate(post_purchase_satisfaction = as.numeric(post_purchase_satisfaction))%>%
na.omit()
customer_satisfaction_num <- customer_satisfaction[,sapply(customer_satisfaction, is.numeric)]
customer_satisfaction_cor <- cor(customer_satisfaction_num)
corrplot(customer_satisfaction_cor)
vehicle_year_df <- df1
#Create new variable for "year lag", How many years old was the purchased vehicle?
purchase_year <- 2013
vehicle_year_df$purchase_vehicle_year_lag <- (purchase_year - vehicle_year_df$purchase_vehicle_year)
boxplot(vehicle_year_df$purchase_vehicle_year_lag)
ggplot(data = vehicle_year_df, aes(y = purchase_vehicle_year_lag)) +
geom_boxplot(outlier.shape = NA)
boxplot(vehicle_year_df$purchase_vehicle_year_lag, range = 2)
boxplot(vehicle_year_df$purchase_vehicle_year_lag, range = 1)
boxplot(vehicle_year_df$purchase_vehicle_year_lag, range = .1)
boxplot(vehicle_year_df$purchase_vehicle_year_lag, range = 6)
boxplot(vehicle_year_df$purchase_vehicle_year_lag, range = 20)
ggplot(data = vehicle_year_df, aes(y = purchase_vehicle_year_lag)) +
geom_boxplot(outlier.shape = NA)
boxplot(vehicle_year_df$purchase_vehicle_year_lag)
vehicle_year_boxplot_df <- vehicle_year_df %>%
filter(purchase_vehicle_year_lag < 20)
vehicle_year_boxplot_df <- vehicle_year_df %>%
filter(purchase_vehicle_year_lag < 20)
boxplot(vehicle_year_boxplot_df$purchase_vehicle_year_lag)
knitr::opts_chunk$set(echo = TRUE)
#Clear workspace
rm(list = ls())
#Set working directory
setwd("C:/Users/Danny/Desktop/CarMax-Analytics-Showcase")
#Import Libraries
library(dplyr)
library(ggplot2)
library(naniar)
library(corrplot)
library(cowplot)
library(randomForest)
#Import Dataset
df1_raw <- read.csv("CaseCompetitionData2021Copy.csv")
#New Dataset for Cleaning and Analysis
df1 <- df1_raw
#Replacing ? Values with NA
df1[df1=="?"]<- NA
#Drop Columns
df1 <- select(df1, -post_purchase_satisfaction)
#Omit NA values
df1 <- na.omit(df1)
#customers by gender
gender_table <- table(df1$customer_gender)
gender_table_df <- as.data.frame(gender_table)
gender_table_df <- rename(gender_table_df, customer_gender = Var1)
#Averages
mean(df1$trade_in)
mean(df1$vehicle_financing)
mean(df1$customer_previous_purchase)
mean(df1$subsequent_purchases)
#Vehicle Sales by Manufacturer
purchase_make_df <- table(df1$purchase_make)
purchase_make_df <- as.data.frame(purchase_make_df)
#Dataframe with Top 10 Sales
top10 <- purchase_make_df %>%
top_n(10, Freq) %>%
arrange(desc(Freq))
#Top Ten Manufacturer as a percentage of Sales Quantity
percent_sales_top_10 <- sum(top10$Freq)/length(df1$purchase_make)
percent_sales_top_10
manufacturer_graph <- ggplot(top10, aes(x=reorder(Var1, -Freq), y=Freq)) +
geom_bar(stat = "identity") +
theme_minimal()
manufacturer_graph
customer_satisfaction <- df1_raw %>%
replace_with_na(list(post_purchase_satisfaction = '?')) %>%
mutate(post_purchase_satisfaction = as.numeric(post_purchase_satisfaction))%>%
na.omit()
customer_satisfaction_num <- customer_satisfaction[,sapply(customer_satisfaction, is.numeric)]
customer_satisfaction_cor <- cor(customer_satisfaction_num)
corrplot(customer_satisfaction_cor)
vehicle_year_df <- df1
#Create new variable for "year lag", How many years old was the purchased vehicle?
purchase_year <- 2013
vehicle_year_df$purchase_vehicle_year_lag <- (purchase_year - vehicle_year_df$purchase_vehicle_year)
#ggplot(data = vehicle_year_df, aes(y = purchase_vehicle_year_lag)) +
#  geom_boxplot(outlier.shape = NA)
#Horrendous code to make the boxplot look better, come back and fix this later
vehicle_year_boxplot_df <- vehicle_year_df %>%
filter(purchase_vehicle_year_lag < 20)
#Probably innaccurate boxplot
boxplot(vehicle_year_boxplot_df$purchase_vehicle_year_lag)
#Vehicle Purchase count by year chart
#Vehicle Purchase county by lag year
View(df1)
ols1 <- lm(subsequent_purchases~purchase_year+trade_in+vehicle_financing+customer_gender, data=df1)
ols1 <- lm(subsequent_purchases ~ vehicle_financing + customer_gender, data=df1)
summary(ols1)
glm1 <- glm(subsequent_purchases ~ vehicle_financing + customer_gender, data=df1)
glm1
summary(glm1)
